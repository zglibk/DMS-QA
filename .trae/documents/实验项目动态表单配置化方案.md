# 实验项目动态表单配置方案

针对您提出的“针对项目，绘制子模块对应的表单控件”需求，我将实施以下方案，实现**动态表单构建器**。这将允许管理员为新的实验项目定义字段，而无需编写新的代码组件。

## 1. 数据库变更

在 `PerformanceItemConfigs` 表中新增 `FormConfig` 列（NVARCHAR(MAX)），用于存储表单的结构定义（JSON格式）。

## 2. 后端 API 更新

更新 `server/routes/performanceInspection.js` 中的配置管理接口（POST/PUT），使其能够接收并保存 `FormConfig` 字段。

## 3. 前端组件开发

### 3.1 `DynamicTestForm.vue` (新组件)

创建一个通用的表单渲染组件，它将根据配置动态生成界面：

* **基础信息区**：根据配置渲染文本框、下拉框、单选框等，绑定到 `Conditions` 对象。

* **结果数据区**：支持配置动态表格（如样品列表），绑定到 `ResultData` 对象。

* **综合判定**：标准的合格/不合格判定。

### 3.2 `PerformanceConfigDialog.vue` (升级)

在配置弹窗中增加“表单设计”功能：

* 当组件类型选择为“动态表单 (Dynamic)”时，显示设计器。

* **字段管理**：允许添加/编辑/删除字段。每个字段包含：

  * 标签 (Label)

  * 键名 (Key)

  * 类型 (文本/数字/选项/日期)

  * 选项列表 (针对下拉/单选)

* **表格配置**：定义结果表格的列结构。

### 3.3 `TestItemsManager.vue` (适配)

更新组件加载逻辑：

* 如果配置的 `ComponentType` 为 `Dynamic`，则加载 `DynamicTestForm` 组件，并将配置数据传递给它。

* 现有的固定组件（如 `AdhesionForm`）保持不变，确保旧数据兼容性。

## 4. 实施步骤

1. 修改数据库结构。
2. 更新后端 API。
3. 开发 `DynamicTestForm.vue`。
4. 改造 `PerformanceConfigDialog.vue` 支持可视化配置。
5. 联调验证。

