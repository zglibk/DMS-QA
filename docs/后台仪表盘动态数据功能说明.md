# åå°ä»ªè¡¨ç›˜åŠ¨æ€æ•°æ®åŠŸèƒ½è¯´æ˜

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

é‡æ–°è®¾è®¡äº†åå°ä»ªè¡¨ç›˜é¡µé¢ï¼ˆ`/admin/dashboard`ï¼‰ï¼Œå°†åŸæ¥çš„é™æ€ç¤ºä¾‹æ•°æ®æ›¿æ¢ä¸ºåŸºäºHomeé¡µé¢ç»Ÿè®¡APIçš„åŠ¨æ€çœŸå®æ•°æ®å±•ç¤ºï¼Œæä¾›äº†å…¨é¢çš„è´¨é‡ç®¡ç†æ•°æ®ç›‘æ§å’Œåˆ†æåŠŸèƒ½ã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

### 1. åŠ¨æ€ç»Ÿè®¡å¡ç‰‡
- **æ€»äº¤ä»˜æ‰¹æ¬¡**ï¼šæ˜¾ç¤ºå½“æœˆæ€»äº¤ä»˜æ‰¹æ¬¡æ•°é‡
- **æ€»æŠ•è¯‰æ•°**ï¼šæ˜¾ç¤ºå½“æœˆæŠ•è¯‰æ€»æ•°ï¼ˆå†…è¯‰+å®¢è¯‰ï¼‰
- **æŠ•è¯‰ç‡**ï¼šåŸºäºäº¤ä»˜æ‰¹æ¬¡è®¡ç®—çš„æŠ•è¯‰ç‡
- **ä¸€æ¬¡äº¤æ£€åˆæ ¼ç‡**ï¼šåŸºäºäº¤æ£€æ‰¹æ¬¡å’Œå†…è¯‰æ•°é‡è®¡ç®—

### 2. è¶‹åŠ¿å¯¹æ¯”åˆ†æ
- **æœˆåº¦å¯¹æ¯”**ï¼šä¸ä¸Šæœˆæ•°æ®è¿›è¡Œå¯¹æ¯”åˆ†æ
- **è¶‹åŠ¿æŒ‡ç¤º**ï¼šæ˜¾ç¤ºä¸Šå‡/ä¸‹é™è¶‹åŠ¿å’Œå…·ä½“ç™¾åˆ†æ¯”
- **æ™ºèƒ½é¢œè‰²**ï¼šä¸Šå‡è¶‹åŠ¿ç»¿è‰²ï¼Œä¸‹é™è¶‹åŠ¿çº¢è‰²

### 3. è´¨é‡æŒ‡æ ‡è¯¦æƒ…
- **ä¸€æ¬¡äº¤æ£€åˆæ ¼ç‡å¡ç‰‡**ï¼šè¯¦ç»†æ˜¾ç¤ºäº¤æ£€æ‰¹æ¬¡å’Œä¸åˆæ ¼æ•°é‡
- **å®¢è¯‰ç‡å¡ç‰‡**ï¼šè¯¦ç»†æ˜¾ç¤ºäº¤ä»˜æ‰¹æ¬¡å’Œå®¢è¯‰æ•°é‡
- **å®æ—¶è®¡ç®—**ï¼šåŸºäºçœŸå®æ•°æ®åŠ¨æ€è®¡ç®—æ¯”ç‡

### 4. å•ä½ç»Ÿè®¡è¡¨æ ¼
- **å„å•ä½æŠ•è¯‰æ˜ç»†**ï¼šæ˜¾ç¤ºæ‰€æœ‰è½¦é—´å’Œéƒ¨é—¨çš„æŠ•è¯‰ç»Ÿè®¡
- **å†…è¯‰/å®¢è¯‰åˆ†ç±»**ï¼šåˆ†åˆ«ç»Ÿè®¡å†…è¯‰å’Œå®¢è¯‰æ•°é‡
- **å æ¯”åˆ†æ**ï¼šæ˜¾ç¤ºå„å•ä½æŠ•è¯‰å æ€»æŠ•è¯‰çš„ç™¾åˆ†æ¯”
- **å¯è§†åŒ–è¿›åº¦æ¡**ï¼šç›´è§‚æ˜¾ç¤ºå„å•ä½æŠ•è¯‰å æ¯”

### 5. æœˆä»½é€‰æ‹©åŠŸèƒ½
- **æœˆä»½åˆ‡æ¢**ï¼šæ”¯æŒé€‰æ‹©ä¸åŒæœˆä»½æŸ¥çœ‹å†å²æ•°æ®
- **å®æ—¶æ›´æ–°**ï¼šåˆ‡æ¢æœˆä»½åè‡ªåŠ¨åˆ·æ–°æ‰€æœ‰ç»Ÿè®¡æ•°æ®
- **é»˜è®¤å½“æœˆ**ï¼šé»˜è®¤æ˜¾ç¤ºå½“å‰æœˆä»½æ•°æ®

## ğŸ¯ æ•°æ®æ¥æº

### APIæ¥å£
- **æœˆåº¦ç»Ÿè®¡**ï¼š`/api/complaint/month-stats`
- **è´¨é‡æŒ‡æ ‡**ï¼š`/api/quality-metrics/month-batch-stats`
- **æŠ•è¯‰åˆ—è¡¨**ï¼š`/api/complaint/list`ï¼ˆç”¨äºè®¡ç®—å†…è¯‰/å®¢è¯‰æ•°é‡ï¼‰

### æ•°æ®ç»“æ„
```javascript
// æœˆåº¦ç»Ÿè®¡æ•°æ®
monthStats: {
  todayCount: 0,        // ä»Šæ—¥æŠ•è¯‰æ•°
  monthCount: 0,        // æœˆåº¦æŠ•è¯‰æ€»æ•°
  monthInnerCount: 0,   // æœˆåº¦å†…è¯‰æ•°
  monthOuterCount: 0    // æœˆåº¦å®¢è¯‰æ•°
}

// è´¨é‡ç»Ÿè®¡æ•°æ®
qualityStats: {
  passRate: 0,          // ä¸€æ¬¡äº¤æ£€åˆæ ¼ç‡
  totalInspections: 0,  // æ€»äº¤æ£€æ‰¹æ¬¡
  failedInspections: 0, // ä¸åˆæ ¼æ‰¹æ¬¡
  complaintRate: 0,     // å®¢è¯‰ç‡
  totalDeliveries: 0,   // æ€»äº¤ä»˜æ‰¹æ¬¡
  complaintBatches: 0   // å®¢è¯‰æ‰¹æ¬¡
}

// å•ä½ç»Ÿè®¡æ•°æ®
unitStats: [
  {
    unit: "è½¦é—´åç§°",
    type: "workshop",   // workshop æˆ– department
    inner: 5,          // å†…è¯‰æ•°é‡
    outer: 2           // å®¢è¯‰æ•°é‡
  }
]
```

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. å“åº”å¼æ•°æ®ç®¡ç†
```javascript
import { ref, computed, onMounted, nextTick } from 'vue'

// å“åº”å¼æ•°æ®
const loading = ref(true)
const selectedMonth = ref(new Date().toISOString().slice(0, 7))
const monthStats = ref({})
const qualityStats = ref({})
const unitStats = ref([])
const lastMonthStats = ref({}) // ç”¨äºè¶‹åŠ¿å¯¹æ¯”
```

### 2. è®¡ç®—å±æ€§
```javascript
// åŠ¨æ€ç”Ÿæˆç»Ÿè®¡å¡ç‰‡æ•°æ®
const statList = computed(() => {
  const totalDeliveries = qualityStats.value.totalDeliveries || 0
  const totalComplaints = monthStats.value.monthCount || 0
  const complaintRate = totalDeliveries > 0 ? 
    (totalComplaints / totalDeliveries * 100).toFixed(2) : 0
  const passRate = qualityStats.value.passRate || 0

  // è®¡ç®—è¶‹åŠ¿ï¼ˆä¸ä¸Šæœˆå¯¹æ¯”ï¼‰
  const deliveryTrend = calculateTrend(totalDeliveries, lastMonthStats.value.totalDeliveries)
  const complaintTrend = calculateTrend(totalComplaints, lastMonthStats.value.monthCount)
  // ...

  return [
    { title: 'æ€»äº¤ä»˜æ‰¹æ¬¡', value: totalDeliveries, trend: deliveryTrend, ... },
    { title: 'æ€»æŠ•è¯‰æ•°', value: totalComplaints, trend: complaintTrend, ... },
    // ...
  ]
})
```

### 3. æ•°æ®è·å–å‡½æ•°
```javascript
// è·å–ä»ªè¡¨ç›˜æ•°æ®
const fetchDashboardData = async () => {
  try {
    loading.value = true
    const token = localStorage.getItem('token')
    
    // å¹¶è¡Œè·å–å½“å‰æœˆä»½å’Œä¸Šæœˆæ•°æ®
    const [currentRes, lastMonthRes] = await Promise.all([
      axios.get('/api/complaint/month-stats', { params: { month: selectedMonth.value } }),
      getLastMonthData(token)
    ])
    
    // å¤„ç†æ•°æ®...
    await fetchQualityStats(token)
  } catch (error) {
    // é”™è¯¯å¤„ç†...
  } finally {
    loading.value = false
  }
}
```

### 4. è¶‹åŠ¿è®¡ç®—
```javascript
// è®¡ç®—è¶‹åŠ¿ç™¾åˆ†æ¯”
const calculateTrend = (current, previous) => {
  if (!previous || previous === 0) return 0
  return ((current - previous) / previous * 100).toFixed(1)
}

// è·å–è¶‹åŠ¿æ ·å¼ç±»
const getTrendClass = (trend) => {
  const trendValue = parseFloat(trend)
  if (trendValue > 0) return 'trend-up'
  if (trendValue < 0) return 'trend-down'
  return ''
}
```

## ğŸ¨ ç•Œé¢è®¾è®¡

### 1. ç°ä»£åŒ–å¡ç‰‡è®¾è®¡
- **åœ†è§’å¡ç‰‡**ï¼š16pxåœ†è§’ï¼Œç°ä»£åŒ–è§†è§‰æ•ˆæœ
- **é˜´å½±æ•ˆæœ**ï¼šæ‚¬åœæ—¶å¡ç‰‡ä¸Šå‡åŠ¨ç”»
- **å›¾æ ‡è®¾è®¡**ï¼šå³ä¸Šè§’å½©è‰²å›¾æ ‡ï¼Œå¢å¼ºè§†è§‰è¯†åˆ«
- **æ¸å˜èƒŒæ™¯**ï¼šæ•´ä½“é¡µé¢ä½¿ç”¨æ·¡é›…æ¸å˜èƒŒæ™¯

### 2. å“åº”å¼å¸ƒå±€
- **ç½‘æ ¼å¸ƒå±€**ï¼šä½¿ç”¨CSS Gridå®ç°è‡ªé€‚åº”å¸ƒå±€
- **ç§»åŠ¨ç«¯ä¼˜åŒ–**ï¼šå°å±å¹•ä¸‹è‡ªåŠ¨è°ƒæ•´ä¸ºå•åˆ—å¸ƒå±€
- **å¼¹æ€§è®¾è®¡**ï¼šå¡ç‰‡å¤§å°æ ¹æ®å†…å®¹è‡ªåŠ¨è°ƒæ•´

### 3. æ•°æ®å¯è§†åŒ–
- **è¿›åº¦æ¡**ï¼šå•ä½å æ¯”ä½¿ç”¨æ¸å˜è¿›åº¦æ¡æ˜¾ç¤º
- **é¢œè‰²ç¼–ç **ï¼šä¸åŒç±»å‹æ•°æ®ä½¿ç”¨ä¸åŒé¢œè‰²æ ‡è¯†
- **æ ‡ç­¾ç³»ç»Ÿ**ï¼šè½¦é—´/éƒ¨é—¨ä½¿ç”¨ä¸åŒé¢œè‰²æ ‡ç­¾åŒºåˆ†

### 4. äº¤äº’ä½“éªŒ
- **åŠ è½½çŠ¶æ€**ï¼šæ•°æ®åŠ è½½æ—¶æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- **æœˆä»½é€‰æ‹©**ï¼šé¡¶éƒ¨æœˆä»½é€‰æ‹©å™¨ï¼Œæ”¯æŒå†å²æ•°æ®æŸ¥çœ‹
- **æ‚¬åœæ•ˆæœ**ï¼šå¡ç‰‡æ‚¬åœæ—¶çš„å¾®åŠ¨ç”»æ•ˆæœ

## ğŸ“Š æ•°æ®å±•ç¤ºç¤ºä¾‹

### ç»Ÿè®¡å¡ç‰‡
```
æ€»äº¤ä»˜æ‰¹æ¬¡: 1,250 æ‰¹æ¬¡    è¾ƒä¸Šæœˆ +5.2%
æ€»æŠ•è¯‰æ•°: 32 ä»¶          è¾ƒä¸Šæœˆ -8.1%
æŠ•è¯‰ç‡: 2.56%           è¾ƒä¸Šæœˆ -0.3%
ä¸€æ¬¡äº¤æ£€åˆæ ¼ç‡: 97.4%    è¾ƒä¸Šæœˆ +1.2%
```

### è´¨é‡æŒ‡æ ‡
```
ä¸€æ¬¡äº¤æ£€åˆæ ¼ç‡: 97.4%
äº¤æ£€æ‰¹æ¬¡: 1,250  ä¸åˆæ ¼: 32

å®¢è¯‰ç‡: 1.6%
äº¤ä»˜æ‰¹æ¬¡: 1,250  å®¢è¯‰: 20
```

### å•ä½ç»Ÿè®¡
```
è½¦é—´A    å†…è¯‰: 5   å®¢è¯‰: 2   æ€»è®¡: 7   å æ¯”: 21.9%
è½¦é—´B    å†…è¯‰: 3   å®¢è¯‰: 1   æ€»è®¡: 4   å æ¯”: 12.5%
éƒ¨é—¨C    å†…è¯‰: 2   å®¢è¯‰: 3   æ€»è®¡: 5   å æ¯”: 15.6%
...
```

## ğŸ”® æœªæ¥æ‰©å±•

### 1. å›¾è¡¨é›†æˆ
- æ·»åŠ è¶‹åŠ¿å›¾è¡¨æ˜¾ç¤ºæœˆåº¦å˜åŒ–
- é¥¼å›¾æ˜¾ç¤ºæŠ•è¯‰ç±»å‹åˆ†å¸ƒ
- æŸ±çŠ¶å›¾æ˜¾ç¤ºå„å•ä½å¯¹æ¯”

### 2. å®æ—¶æ›´æ–°
- WebSocketå®æ—¶æ•°æ®æ¨é€
- è‡ªåŠ¨åˆ·æ–°æœºåˆ¶
- æ•°æ®å˜åŒ–æé†’

### 3. å¯¼å‡ºåŠŸèƒ½
- ä»ªè¡¨ç›˜æ•°æ®å¯¼å‡º
- æŠ¥è¡¨ç”ŸæˆåŠŸèƒ½
- å®šæœŸæŠ¥å‘Šé‚®ä»¶

### 4. æƒé™æ§åˆ¶
- ä¸åŒè§’è‰²çœ‹åˆ°ä¸åŒæ•°æ®
- æ•æ„Ÿæ•°æ®æƒé™æ§åˆ¶
- æ“ä½œæ—¥å¿—è®°å½•

## ğŸ“ ç›¸å…³æ–‡ä»¶

### å‰ç«¯æ–‡ä»¶
- `frontend/src/views/admin/Dashboard.vue` - ä»ªè¡¨ç›˜ä¸»é¡µé¢
- `frontend/src/views/Home.vue` - æ•°æ®æºå‚è€ƒ

### åç«¯API
- `server/routes/complaint.js` - æŠ•è¯‰ç»Ÿè®¡API
- `server/routes/quality-metrics.js` - è´¨é‡æŒ‡æ ‡API

### æ•°æ®åº“è¡¨
- `ComplaintRegister` - æŠ•è¯‰è®°å½•ä¸»è¡¨
- `MonthlyBatchStats` - æœˆåº¦æ‰¹æ¬¡ç»Ÿè®¡è¡¨

## ğŸ‰ æ€»ç»“

é‡æ–°è®¾è®¡çš„åå°ä»ªè¡¨ç›˜æä¾›äº†ï¼š

1. âœ… **çœŸå®æ•°æ®å±•ç¤º** - åŸºäºå®é™…ä¸šåŠ¡æ•°æ®çš„åŠ¨æ€å±•ç¤º
2. âœ… **è¶‹åŠ¿åˆ†æ** - æœˆåº¦å¯¹æ¯”å’Œè¶‹åŠ¿æŒ‡ç¤º
3. âœ… **å…¨é¢ç»Ÿè®¡** - æ¶µç›–æŠ•è¯‰ã€è´¨é‡ã€å•ä½ç­‰å¤šç»´åº¦æ•°æ®
4. âœ… **ç°ä»£åŒ–ç•Œé¢** - å“åº”å¼è®¾è®¡å’Œä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒ
5. âœ… **å®æ—¶æ›´æ–°** - æ”¯æŒæœˆä»½åˆ‡æ¢å’Œæ•°æ®åˆ·æ–°
6. âœ… **ç§»åŠ¨ç«¯é€‚é…** - å®Œç¾æ”¯æŒå„ç§å±å¹•å°ºå¯¸

è¯¥ä»ªè¡¨ç›˜ä¸ºç®¡ç†è€…æä¾›äº†å…¨é¢çš„è´¨é‡ç®¡ç†æ•°æ®æ¦‚è§ˆï¼Œæ”¯æŒå¿«é€Ÿäº†è§£å½“å‰è´¨é‡çŠ¶å†µå’Œè¶‹åŠ¿å˜åŒ–ï¼Œä¸ºå†³ç­–æä¾›æœ‰åŠ›çš„æ•°æ®æ”¯æŒã€‚

---

**åŠŸèƒ½å¼€å‘æ—¶é—´**: 2025å¹´7æœˆ9æ—¥  
**å¼€å‘è€…**: David Lee (zglibk)  
**ç‰ˆæœ¬**: v2.2.6
