# 二次开发模块说明

## 概述

本文档介绍了DMS-QA质量管理系统中新增的"二次开发"模块，该模块旨在为开发者提供可复用的组件和开发工具，便于系统的扩展和维护。

## 模块结构

### 菜单层级
```
二次开发 (development)
└── 结构组件 (structure-components)
    ├── 表格组件
    │   └── 手风琴表格
    └── 表单组件
        └── 动态表单（开发中）
```

### 文件结构
```
frontend/src/
├── views/development/
│   └── StructureComponents.vue     # 结构组件主页面
├── components/
│   ├── AccordionTable.vue          # 手风琴表格组件
│   └── README.md                   # 组件使用说明
├── examples/
│   └── AccordionTableExample.vue   # 手风琴表格示例
└── docs/
    └── AccordionTable.md           # 详细API文档

server/scripts/
├── add-development-menus.js        # 菜单添加脚本
└── add-development-menus.sql       # SQL脚本
```

## 功能特性

### 1. 结构组件页面
- **上下布局结构**：页面分为标题说明区域和内容展示区域
- **左右分栏设计**：左侧为组件树形菜单，右侧为详细说明
- **组件预览**：支持实时预览组件效果
- **代码示例**：提供完整的使用代码示例
- **API文档**：链接到详细的API文档

### 2. 手风琴表格组件
- **树形数据展示**：支持多层级树形数据
- **手风琴效果**：展开一个节点时自动折叠同级其他节点
- **操作按钮**：支持展开全部/收起全部操作
- **可配置列**：灵活的表格列配置
- **自定义插槽**：支持自定义内容插槽
- **完全可复用**：独立的组件设计，易于复用

## 访问路径

### 前端路由
- 结构组件页面：`/admin/development/structure-components`
- 手风琴表格示例：`/admin/system/accordion-table-example`

### 菜单权限
- 菜单编码：`development`（二次开发）
- 子菜单编码：`structure-components`（结构组件）
- 权限标识：`development:view`、`development:structure:view`
- 默认分配给：系统管理员角色

## 数据库配置

### 菜单表数据
```sql
-- 二次开发顶级菜单
INSERT INTO Menus (MenuCode, MenuName, Icon, Path, Permission, SortOrder)
VALUES ('development', '二次开发', 'Tools', '/development', 'development:view', 100);

-- 结构组件子菜单
INSERT INTO Menus (ParentID, MenuCode, MenuName, Icon, Path, Component, Permission, SortOrder)
VALUES (@developmentMenuId, 'structure-components', '结构组件', 'Grid', 
        '/development/structure-components', 'development/StructureComponents', 
        'development:structure:view', 10);
```

### 角色权限分配
- 系统管理员角色自动获得所有二次开发模块的访问权限
- 可通过角色管理页面为其他角色分配相应权限

## 使用指南

### 1. 访问结构组件页面
1. 使用管理员账号登录系统
2. 在左侧菜单中找到"二次开发"菜单
3. 点击"结构组件"子菜单
4. 进入结构组件展示页面

### 2. 查看手风琴表格组件
1. 在结构组件页面左侧树形菜单中
2. 展开"表格组件"节点
3. 点击"手风琴表格"项目
4. 右侧将显示组件的详细说明和预览

### 3. 使用手风琴表格组件
```vue
<template>
  <AccordionTable
    :data="tableData"
    :columns="columns"
    :accordion="true"
    :show-actions="true"
    row-key="id"
    @expand-change="handleExpandChange"
  />
</template>

<script setup>
import AccordionTable from '@/components/AccordionTable.vue'

const tableData = ref([
  {
    id: '1',
    name: '一级菜单1',
    children: [
      { id: '1-1', name: '二级菜单1-1' },
      { id: '1-2', name: '二级菜单1-2' }
    ]
  }
])

const columns = [
  { prop: 'name', label: '名称', width: 200 }
]

function handleExpandChange(row, expanded) {
  console.log('展开状态变化:', row, expanded)
}
</script>
```

## 开发说明

### 1. 添加新组件
1. 在 `frontend/src/components/` 目录下创建新组件
2. 在 `frontend/src/examples/` 目录下创建使用示例
3. 在结构组件页面的 `componentDetails` 中添加组件信息
4. 更新 `componentTree` 数据结构

### 2. 组件开发规范
- 使用Vue 3 Composition API
- 添加详细的JSDoc注释
- 提供完整的Props定义和类型检查
- 支持事件发射和插槽
- 编写使用示例和API文档

### 3. 菜单扩展
如需添加新的二次开发子菜单：
1. 在数据库Menus表中添加菜单记录
2. 在前端路由中添加对应路由配置
3. 为相应角色分配菜单权限
4. 创建对应的Vue组件

## 技术栈

- **前端框架**：Vue 3 + Composition API
- **UI组件库**：Element Plus
- **路由管理**：Vue Router 4
- **状态管理**：Pinia（如需要）
- **构建工具**：Vite
- **数据库**：SQL Server
- **后端框架**：Node.js + Express

## 注意事项

1. **权限控制**：所有二次开发模块的页面都需要登录认证
2. **浏览器兼容性**：建议使用现代浏览器（Chrome、Firefox、Edge等）
3. **响应式设计**：页面支持不同屏幕尺寸的自适应显示
4. **性能优化**：使用懒加载和代码分割优化加载性能

## 更新日志

### v1.0.0 (2024-01-XX)
- ✅ 创建二次开发模块基础架构
- ✅ 实现结构组件展示页面
- ✅ 集成手风琴表格组件
- ✅ 添加菜单权限配置
- ✅ 完善文档和使用说明

## 贡献指南

如需为二次开发模块贡献代码或添加新组件，请遵循以下步骤：

1. Fork项目仓库
2. 创建功能分支
3. 编写代码和测试
4. 添加文档说明
5. 提交Pull Request

## 联系方式

如有问题或建议，请联系开发团队或在项目仓库中提交Issue。