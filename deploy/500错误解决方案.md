# IIS 500.19错误解决方案

## 🚨 错误分析
错误代码：`0x80070005` - 配置文件访问被拒绝

## 🔧 解决步骤（按顺序执行）

### 方案一：使用最简化配置（推荐先试）

1. **替换web.config文件**
   ```
   将 deploy/web-minimal.config 重命名为 web.config
   复制到IIS网站根目录，覆盖现有文件
   ```

2. **重启IIS站点**
   - 在IIS管理器中停止站点
   - 重新启动站点

### 方案二：检查IIS功能模块

运行管理员命令提示符，执行：
```cmd
# 检查URL重写模块
dism /online /get-features | findstr "IIS-HttpRedirect"

# 启用必要功能
dism /online /enable-feature /featurename:IIS-HttpRedirect /all
dism /online /enable-feature /featurename:IIS-HttpCompressionStatic /all
dism /online /enable-feature /featurename:IIS-HttpCompressionDynamic /all

# 重启IIS
iisreset
```

### 方案三：检查文件权限

1. **右键网站根目录** → 属性 → 安全
2. **添加权限**：
   - `IIS_IUSRS` - 读取和执行
   - `IUSR` - 读取
   - `应用程序池标识` - 完全控制

### 方案四：逐步添加配置

如果最简化配置工作正常，逐步添加功能：

1. **基础配置**（web-minimal.config）
2. **添加MIME类型**
3. **添加错误处理**
4. **添加安全头**
5. **添加压缩**

每添加一项就测试一次，找出问题配置。

## 📋 配置文件对比

### 最简化版本（web-minimal.config）
- ✅ 默认文档
- ✅ 目录浏览禁用
- ✅ URL重写（基础）

### 完整版本（web.config）
- ✅ 上述所有功能
- ➕ MIME类型配置
- ➕ HTTP错误处理
- ➕ 安全头
- ➕ 压缩配置

## 🎯 测试步骤

1. **测试首页**：`http://172.27.84.114/`
2. **测试路由**：`http://172.27.84.114/login`
3. **检查错误日志**：IIS管理器 → 日志文件

## 🆘 如果仍然失败

1. **查看详细错误**：
   - IIS管理器 → 错误页面 → 编辑功能设置
   - 选择"详细错误"

2. **检查事件日志**：
   - Windows事件查看器
   - Windows日志 → 系统
   - 应用程序和服务日志 → Microsoft → Windows → IIS-Configuration

3. **临时禁用功能**：
   - 注释掉web.config中的问题部分
   - 逐个启用功能

## 📞 常见解决方案

| 错误特征 | 解决方案 |
|---------|---------|
| URL重写相关 | 确认重写模块已安装 |
| MIME类型相关 | 移除staticContent部分 |
| 压缩相关 | 移除httpCompression部分 |
| 安全头相关 | 移除httpProtocol部分 |
